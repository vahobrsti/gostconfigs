global
   log "stdout" format rfc5424 daemon  notice
   #spread-checks 5

resolvers dns-crypt
   parse-resolv-conf
   hold valid 30s
   # How many times to retry a query
defaults
   default-server resolvers dns-crypt
   mode tcp
   log global
   log-format " %ci:%cp [%t]  %ft port %fp  %b/%s %Tw/%Tc/%Tt %B %ts  %ac/%fc/%bc/%sc/%rc %sq/%bq "
   balance leastconn
   timeout connect 5s
   timeout server 30s
   timeout client 30s
   default-server inter 10s

frontend xray-frontend
   bind *:443  #xray tcp tls
   bind *:3443  #xray tcp tls vision
   bind *:7443 #xray h2 tls
   bind *:6443 #xray tcp tls
   bind *:8443 #xray tcp tls

   # port 443 was required for AdGuard home and DNS over https. mapping to a new port config [start]
   acl acl_443 dst_port 443
   tcp-request connection set-dst-port int(4443) if acl_443
   # port 443 was required for AdGuard home and DNS over https. mapping to a new port config [end]
   use_backend xray-backend-servers


backend xray-backend-servers
   option tcp-check
   tcp-check connect port 6443
   tcp-check connect port 8443
   server lux001    [2605:6400:d4e0:2::]   check
   server lux002    [2605:6400:d4e0:2::1]   check
   server lux003    [2605:6400:d4e0:2::2]   check
   server lux004    [2605:6400:d4e0:2::3]   check
   server lux005    [2605:6400:d4e0:2::4]   check
   server lux006    [2605:6400:d4e0:2::5]   check
   server lux007    [2605:6400:d4e0:2::6]   check
   server lux008    [2605:6400:d4e0:2::7]   check
   server lux009    [2605:6400:d4e0:2::8]   check
   server lux010    [2605:6400:d4e0:2::9]   check
   server lux011    [2605:6400:d4e0:2::a]   check
   server lux012    [2605:6400:d4e0:2::b]   check
   server lux013    [2605:6400:d4e0:2::c]   check
   server lux014    [2605:6400:d4e0:2::d]   check
   server lux015    [2605:6400:d4e0:2::e]   check
   server lux016    [2605:6400:d4e0:2::f]   check
   server lux017    [2605:6400:d4e0:2::10]   check
   server lux018    [2605:6400:d4e0:2::11]   check
   server lux019    [2605:6400:d4e0:2::12]   check
   server lux020    [2605:6400:d4e0:2::13]   check
   server lux021    [2605:6400:d4e0:2::14]   check
   server lux022    [2605:6400:d4e0:2::15]   check
   server lux023    [2605:6400:d4e0:2::16]   check
   server lux024    [2605:6400:d4e0:2::17]   check
   server lux025    [2605:6400:d4e0:2::18]   check
   server lux026    [2605:6400:d4e0:2::19]   check
   server lux027    [2605:6400:d4e0:2::1a]   check
   server lux028    [2605:6400:d4e0:2::1b]   check
   server lux029    [2605:6400:d4e0:2::1c]   check
   server lux030    [2605:6400:d4e0:2::1d]   check
   server lux031    [2605:6400:d4e0:2::1e]   check
   server lux032    [2605:6400:d4e0:2::1f]   check
   server lux033    [2605:6400:d4e0:2::20]   check
   server lux034    [2605:6400:d4e0:2::21]   check
   server lux035    [2605:6400:d4e0:2::22]   check
   server lux036    [2605:6400:d4e0:2::23]   check
   server lux037    [2605:6400:d4e0:2::24]   check
   server lux038    [2605:6400:d4e0:2::25]   check
   server lux039    [2605:6400:d4e0:2::26]   check
   server lux040    [2605:6400:d4e0:2::27]   check
   server lux041    [2605:6400:d4e0:2::28]   check
   server lux042    [2605:6400:d4e0:2::29]   check
   server lux043    [2605:6400:d4e0:2::2a]   check
   server lux044    [2605:6400:d4e0:2::2b]   check
   server lux045    [2605:6400:d4e0:2::2c]   check
   server lux046    [2605:6400:d4e0:2::2d]   check
   server lux047    [2605:6400:d4e0:2::2e]   check
   server lux048    [2605:6400:d4e0:2::2f]   check
   server lux049    [2605:6400:d4e0:2::30]   check
   server lux050    [2605:6400:d4e0:2::31]   check
   server lux051    [2605:6400:d4e0:2::32]   check
   server lux052    [2605:6400:d4e0:2::33]   check
   server lux053    [2605:6400:d4e0:2::34]   check
   server lux054    [2605:6400:d4e0:2::35]   check
   server lux055    [2605:6400:d4e0:2::36]   check
   server lux056    [2605:6400:d4e0:2::37]   check
   server lux057    [2605:6400:d4e0:2::38]   check
   server lux058    [2605:6400:d4e0:2::39]   check
   server lux059    [2605:6400:d4e0:2::3a]   check
   server lux060    [2605:6400:d4e0:2::3b]   check
   server lux061    [2605:6400:d4e0:2::3c]   check
   server lux062    [2605:6400:d4e0:2::3d]   check
   server lux063    [2605:6400:d4e0:2::3e]   check
   server lux064    [2605:6400:d4e0:2::3f]   check
   server lux065    [2605:6400:d4e0:2::40]   check
   server lux066    [2605:6400:d4e0:2::41]   check
   server lux067    [2605:6400:d4e0:2::42]   check
   server lux068    [2605:6400:d4e0:2::43]   check
   server lux069    [2605:6400:d4e0:2::44]   check
   server lux070    [2605:6400:d4e0:2::45]   check
   server lux071    [2605:6400:d4e0:2::46]   check
   server lux072    [2605:6400:d4e0:2::47]   check
   server lux073    [2605:6400:d4e0:2::48]   check
   server lux074    [2605:6400:d4e0:2::49]   check
   server lux075    [2605:6400:d4e0:2::4a]   check
   server lux076    [2605:6400:d4e0:2::4b]   check
   server lux077    [2605:6400:d4e0:2::4c]   check
   server lux078    [2605:6400:d4e0:2::4d]   check
   server lux079    [2605:6400:d4e0:2::4e]   check
   server lux080    [2605:6400:d4e0:2::4f]   check
   server lux081    [2605:6400:d4e0:2::50]   check
   server lux082    [2605:6400:d4e0:2::51]   check
   server lux083    [2605:6400:d4e0:2::52]   check
   server lux084    [2605:6400:d4e0:2::53]   check
   server lux085    [2605:6400:d4e0:2::54]   check
   server lux086    [2605:6400:d4e0:2::55]   check
   server lux087    [2605:6400:d4e0:2::56]   check
   server lux088    [2605:6400:d4e0:2::57]   check
   server lux089    [2605:6400:d4e0:2::58]   check
   server lux090    [2605:6400:d4e0:2::59]   check
   server lux091    [2605:6400:d4e0:2::5a]   check
   server lux092    [2605:6400:d4e0:2::5b]   check
   server lux093    [2605:6400:d4e0:2::5c]   check
   server lux094    [2605:6400:d4e0:2::5d]   check
   server lux095    [2605:6400:d4e0:2::5e]   check
   server lux096    [2605:6400:d4e0:2::5f]   check
   server lux097    [2605:6400:d4e0:2::60]   check
   server lux098    [2605:6400:d4e0:2::61]   check
   server lux099    [2605:6400:d4e0:2::62]   check
   server lux100    [2605:6400:d4e0:2::63]   check
   server lux101    [2605:6400:d4e0:2::64]   check
   server lux102    [2605:6400:d4e0:2::65]   check
   server lux103    [2605:6400:d4e0:2::66]   check
   server lux104    [2605:6400:d4e0:2::67]   check
   server lux105    [2605:6400:d4e0:2::68]   check
   server lux106    [2605:6400:d4e0:2::69]   check
   server lux107    [2605:6400:d4e0:2::6a]   check
   server lux108    [2605:6400:d4e0:2::6b]   check
   server lux109    [2605:6400:d4e0:2::6c]   check
   server lux110    [2605:6400:d4e0:2::6d]   check
   server lux111    [2605:6400:d4e0:2::6e]   check
   server lux112    [2605:6400:d4e0:2::6f]   check
   server lux113    [2605:6400:d4e0:2::70]   check
   server lux114    [2605:6400:d4e0:2::71]   check
   server lux115    [2605:6400:d4e0:2::72]   check
   server lux116    [2605:6400:d4e0:2::73]   check
   server lux117    [2605:6400:d4e0:2::74]   check
   server lux118    [2605:6400:d4e0:2::75]   check
   server lux119    [2605:6400:d4e0:2::76]   check
   server lux120    [2605:6400:d4e0:2::77]   check
   server lux121    [2605:6400:d4e0:2::78]   check
   server lux122    [2605:6400:d4e0:2::79]   check
   server lux123    [2605:6400:d4e0:2::7a]   check
   server lux124    [2605:6400:d4e0:2::7b]   check
   server lux125    [2605:6400:d4e0:2::7c]   check
   server lux126    [2605:6400:d4e0:2::7d]   check
   server lux127    [2605:6400:d4e0:2::7e]   check
   server lux128    [2605:6400:d4e0:2::7f]   check
   server lux129    [2605:6400:d4e0:2::80]   check
   server lux130    [2605:6400:d4e0:2::81]   check
   server lux131    [2605:6400:d4e0:2::82]   check
   server lux132    [2605:6400:d4e0:2::83]   check
   server lux133    [2605:6400:d4e0:2::84]   check
   server lux134    [2605:6400:d4e0:2::85]   check
   server lux135    [2605:6400:d4e0:2::86]   check
   server lux136    [2605:6400:d4e0:2::87]   check
   server lux137    [2605:6400:d4e0:2::88]   check
   server lux138    [2605:6400:d4e0:2::89]   check
   server lux139    [2605:6400:d4e0:2::8a]   check
   server lux140    [2605:6400:d4e0:2::8b]   check
   server lux141    [2605:6400:d4e0:2::8c]   check
   server lux142    [2605:6400:d4e0:2::8d]   check
   server lux143    [2605:6400:d4e0:2::8e]   check
   server lux144    [2605:6400:d4e0:2::8f]   check
   server lux145    [2605:6400:d4e0:2::90]   check
   server lux146    [2605:6400:d4e0:2::91]   check
   server lux147    [2605:6400:d4e0:2::92]   check
   server lux148    [2605:6400:d4e0:2::93]   check
   server lux149    [2605:6400:d4e0:2::94]   check
   server lux150    [2605:6400:d4e0:2::95]   check
   server lux151    [2605:6400:d4e0:2::96]   check
   server lux152    [2605:6400:d4e0:2::97]   check
   server lux153    [2605:6400:d4e0:2::98]   check
   server lux154    [2605:6400:d4e0:2::99]   check
   server lux155    [2605:6400:d4e0:2::9a]   check
   server lux156    [2605:6400:d4e0:2::9b]   check
   server lux157    [2605:6400:d4e0:2::9c]   check
   server lux158    [2605:6400:d4e0:2::9d]   check
   server lux159    [2605:6400:d4e0:2::9e]   check
   server lux160    [2605:6400:d4e0:2::9f]   check
   server lux161    [2605:6400:d4e0:2::a0]   check
   server lux162    [2605:6400:d4e0:2::a1]   check
   server lux163    [2605:6400:d4e0:2::a2]   check
   server lux164    [2605:6400:d4e0:2::a3]   check
   server lux165    [2605:6400:d4e0:2::a4]   check
   server lux166    [2605:6400:d4e0:2::a5]   check
   server lux167    [2605:6400:d4e0:2::a6]   check
   server lux168    [2605:6400:d4e0:2::a7]   check
   server lux169    [2605:6400:d4e0:2::a8]   check
   server lux170    [2605:6400:d4e0:2::a9]   check
   server lux171    [2605:6400:d4e0:2::aa]   check
   server lux172    [2605:6400:d4e0:2::ab]   check
   server lux173    [2605:6400:d4e0:2::ac]   check
   server lux174    [2605:6400:d4e0:2::ad]   check
   server lux175    [2605:6400:d4e0:2::ae]   check
   server lux176    [2605:6400:d4e0:2::af]   check
   server lux177    [2605:6400:d4e0:2::b0]   check
   server lux178    [2605:6400:d4e0:2::b1]   check
   server lux179    [2605:6400:d4e0:2::b2]   check
   server lux180    [2605:6400:d4e0:2::b3]   check
   server lux181    [2605:6400:d4e0:2::b4]   check
   server lux182    [2605:6400:d4e0:2::b5]   check
   server lux183    [2605:6400:d4e0:2::b6]   check
   server lux184    [2605:6400:d4e0:2::b7]   check
   server lux185    [2605:6400:d4e0:2::b8]   check
   server lux186    [2605:6400:d4e0:2::b9]   check
   server lux187    [2605:6400:d4e0:2::ba]   check
   server lux188    [2605:6400:d4e0:2::bb]   check
   server lux189    [2605:6400:d4e0:2::bc]   check
   server lux190    [2605:6400:d4e0:2::bd]   check
   server lux191    [2605:6400:d4e0:2::be]   check
   server lux192    [2605:6400:d4e0:2::bf]   check
   server lux193    [2605:6400:d4e0:2::c0]   check
   server lux194    [2605:6400:d4e0:2::c1]   check
   server lux195    [2605:6400:d4e0:2::c2]   check
   server lux196    [2605:6400:d4e0:2::c3]   check
   server lux197    [2605:6400:d4e0:2::c4]   check
   server lux198    [2605:6400:d4e0:2::c5]   check
   server lux199    [2605:6400:d4e0:2::c6]   check
   server lux200    [2605:6400:d4e0:2::c7]   check
   server lux201    [2605:6400:d4e0:2::c8]   check
   server lux202    [2605:6400:d4e0:2::c9]   check
   server lux203    [2605:6400:d4e0:2::ca]   check
   server lux204    [2605:6400:d4e0:2::cb]   check
   server lux205    [2605:6400:d4e0:2::cc]   check
   server lux206    [2605:6400:d4e0:2::cd]   check
   server lux207    [2605:6400:d4e0:2::ce]   check
   server lux208    [2605:6400:d4e0:2::cf]   check
   server lux209    [2605:6400:d4e0:2::d0]   check
   server lux210    [2605:6400:d4e0:2::d1]   check
   server lux211    [2605:6400:d4e0:2::d2]   check
   server lux212    [2605:6400:d4e0:2::d3]   check
   server lux213    [2605:6400:d4e0:2::d4]   check
   server lux214    [2605:6400:d4e0:2::d5]   check
   server lux215    [2605:6400:d4e0:2::d6]   check
   server lux216    [2605:6400:d4e0:2::d7]   check
   server lux217    [2605:6400:d4e0:2::d8]   check
   server lux218    [2605:6400:d4e0:2::d9]   check
   server lux219    [2605:6400:d4e0:2::da]   check
   server lux220    [2605:6400:d4e0:2::db]   check
   server lux221    [2605:6400:d4e0:2::dc]   check
   server lux222    [2605:6400:d4e0:2::dd]   check
   server lux223    [2605:6400:d4e0:2::de]   check
   server lux224    [2605:6400:d4e0:2::df]   check
   server lux225    [2605:6400:d4e0:2::e0]   check
   server lux226    [2605:6400:d4e0:2::e1]   check
   server lux227    [2605:6400:d4e0:2::e2]   check
   server lux228    [2605:6400:d4e0:2::e3]   check
   server lux229    [2605:6400:d4e0:2::e4]   check
   server lux230    [2605:6400:d4e0:2::e5]   check
   server lux231    [2605:6400:d4e0:2::e6]   check
   server lux232    [2605:6400:d4e0:2::e7]   check
   server lux233    [2605:6400:d4e0:2::e8]   check
   server lux234    [2605:6400:d4e0:2::e9]   check
   server lux235    [2605:6400:d4e0:2::ea]   check
   server lux236    [2605:6400:d4e0:2::eb]   check
   server lux237    [2605:6400:d4e0:2::ec]   check
   server lux238    [2605:6400:d4e0:2::ed]   check
   server lux239    [2605:6400:d4e0:2::ee]   check
   server lux240    [2605:6400:d4e0:2::ef]   check
   server lux241    [2605:6400:d4e0:2::f0]   check
   server lux242    [2605:6400:d4e0:2::f1]   check
   server lux243    [2605:6400:d4e0:2::f2]   check
   server lux244    [2605:6400:d4e0:2::f3]   check
   server lux245    [2605:6400:d4e0:2::f4]   check
   server lux246    [2605:6400:d4e0:2::f5]   check
   server lux247    [2605:6400:d4e0:2::f6]   check
   server lux248    [2605:6400:d4e0:2::f7]   check
   server lux249    [2605:6400:d4e0:2::f8]   check
   server lux250    [2605:6400:d4e0:2::f9]   check


frontend ocserv-vpn
   bind *:4433 # openconnect server
   # When operating HAProxy in TCP mode, which is set with mode tcp, timeout server should be the same as timeout client. Link: https://gitlab.com/openconnect/ocserv/-/issues/431
   timeout client 305s
   use_backend ocserv-backend-servers


backend ocserv-backend-servers
   # When operating HAProxy in TCP mode, which is set with mode tcp, timeout server should be the same as timeout client.[start]
   timeout server 305s
   # When operating HAProxy in TCP mode, which is set with mode tcp, timeout server should be the same as timeout client.[end]
   option tcp-check
   tcp-check connect port 7443
   balance source
   server Poland6    admin6.somimobile.com   send-proxy-v2 check
   server Poland     admin.somimobile.com   send-proxy-v2 check
   server France     airline.somimobile.com send-proxy-v2 check
   server Milan      mxp.somimobile.com     send-proxy-v2 check


frontend xray-apac-vpn
   bind *:1443 # xray singapore
   use_backend xray-apac-backend-servers

backend xray-apac-backend-servers
   server singapore    apac.somimobile.com

