global
   log "stdout" format rfc5424 daemon  notice
   #spread-checks 5

resolvers dns-crypt
   parse-resolv-conf
   hold valid 30s
   # How many times to retry a query
defaults
   default-server resolvers dns-crypt
   mode tcp
   log global
   log-format " %ci:%cp [%t]  %ft port %fp  %b/%s %Tw/%Tc/%Tt %B %ts  %ac/%fc/%bc/%sc/%rc %sq/%bq "
   balance leastconn
   timeout connect 5s
   timeout server 30s
   timeout client 30s
   default-server inter 10s

frontend xray-frontend
   bind *:443  #xray tcp tls
   bind *:3443  #xray tcp tls vision
   bind *:7443 #xray h2 tls
   bind *:6443 #xray tcp tls
   bind *:8443 #xray tcp tls

   # port 443 was required for AdGuard home and DNS over https. mapping to a new port config [start]
   acl acl_443 dst_port 443
   tcp-request connection set-dst-port int(4443) if acl_443
   # port 443 was required for AdGuard home and DNS over https. mapping to a new port config [end]
   use_backend xray-backend-servers


backend xray-backend-servers
   option tcp-check
   tcp-check connect port 6443
   tcp-check connect port 8443
   server lux001    ipv6@2605:6400:d4e0:1::3   check
   server lux002    ipv6@2605:6400:d4e0:1::4   check
   server lux003    ipv6@2605:6400:d4e0:1::5   check
   server lux004    ipv6@2605:6400:d4e0:1::6   check
   server lux005    ipv6@2605:6400:d4e0:1::7   check
   server lux006    ipv6@2605:6400:d4e0:1::8   check
   server lux007    ipv6@2605:6400:d4e0:1::9   check
   server lux008    ipv6@2605:6400:d4e0:1::a   check
   server lux009    ipv6@2605:6400:d4e0:1::b   check
   server lux010    ipv6@2605:6400:d4e0:1::c   check
   server lux011    ipv6@2605:6400:d4e0:1::d   check
   server lux012    ipv6@2605:6400:d4e0:1::e   check
   server lux013    ipv6@2605:6400:d4e0:1::f   check
   server lux014    ipv6@2605:6400:d4e0:1::10   check
   server lux015    ipv6@2605:6400:d4e0:1::11   check
   server lux016    ipv6@2605:6400:d4e0:1::12   check
   server lux017    ipv6@2605:6400:d4e0:1::13   check
   server lux018    ipv6@2605:6400:d4e0:1::14   check
   server lux019    ipv6@2605:6400:d4e0:1::15   check
   server lux020    ipv6@2605:6400:d4e0:1::16   check
   server lux021    ipv6@2605:6400:d4e0:1::17   check
   server lux022    ipv6@2605:6400:d4e0:1::18   check
   server lux023    ipv6@2605:6400:d4e0:1::19   check
   server lux024    ipv6@2605:6400:d4e0:1::1a   check
   server lux025    ipv6@2605:6400:d4e0:1::1b   check
   server lux026    ipv6@2605:6400:d4e0:1::1c   check
   server lux027    ipv6@2605:6400:d4e0:1::1d   check
   server lux028    ipv6@2605:6400:d4e0:1::1e   check
   server lux029    ipv6@2605:6400:d4e0:1::1f   check
   server lux030    ipv6@2605:6400:d4e0:1::20   check
   server lux031    ipv6@2605:6400:d4e0:1::21   check
   server lux032    ipv6@2605:6400:d4e0:1::22   check
   server lux033    ipv6@2605:6400:d4e0:1::23   check
   server lux034    ipv6@2605:6400:d4e0:1::24   check
   server lux035    ipv6@2605:6400:d4e0:1::25   check
   server lux036    ipv6@2605:6400:d4e0:1::26   check
   server lux037    ipv6@2605:6400:d4e0:1::27   check
   server lux038    ipv6@2605:6400:d4e0:1::28   check
   server lux039    ipv6@2605:6400:d4e0:1::29   check
   server lux040    ipv6@2605:6400:d4e0:1::2a   check
   server lux041    ipv6@2605:6400:d4e0:1::2b   check
   server lux042    ipv6@2605:6400:d4e0:1::2c   check
   server lux043    ipv6@2605:6400:d4e0:1::2d   check
   server lux044    ipv6@2605:6400:d4e0:1::2e   check
   server lux045    ipv6@2605:6400:d4e0:1::2f   check
   server lux046    ipv6@2605:6400:d4e0:1::30   check
   server lux047    ipv6@2605:6400:d4e0:1::31   check
   server lux048    ipv6@2605:6400:d4e0:1::32   check
   server lux049    ipv6@2605:6400:d4e0:1::33   check
   server lux050    ipv6@2605:6400:d4e0:1::34   check
   server lux051    ipv6@2605:6400:d4e0:1::35   check
   server lux052    ipv6@2605:6400:d4e0:1::36   check
   server lux053    ipv6@2605:6400:d4e0:1::37   check
   server lux054    ipv6@2605:6400:d4e0:1::38   check
   server lux055    ipv6@2605:6400:d4e0:1::39   check
   server lux056    ipv6@2605:6400:d4e0:1::3a   check
   server lux057    ipv6@2605:6400:d4e0:1::3b   check
   server lux058    ipv6@2605:6400:d4e0:1::3c   check
   server lux059    ipv6@2605:6400:d4e0:1::3d   check
   server lux060    ipv6@2605:6400:d4e0:1::3e   check
   server lux061    ipv6@2605:6400:d4e0:1::3f   check
   server lux062    ipv6@2605:6400:d4e0:1::40   check
   server lux063    ipv6@2605:6400:d4e0:1::41   check
   server lux064    ipv6@2605:6400:d4e0:1::42   check
   server lux065    ipv6@2605:6400:d4e0:1::43   check
   server lux066    ipv6@2605:6400:d4e0:1::44   check
   server lux067    ipv6@2605:6400:d4e0:1::45   check
   server lux068    ipv6@2605:6400:d4e0:1::46   check
   server lux069    ipv6@2605:6400:d4e0:1::47   check
   server lux070    ipv6@2605:6400:d4e0:1::48   check
   server lux071    ipv6@2605:6400:d4e0:1::49   check
   server lux072    ipv6@2605:6400:d4e0:1::4a   check
   server lux073    ipv6@2605:6400:d4e0:1::4b   check
   server lux074    ipv6@2605:6400:d4e0:1::4c   check
   server lux075    ipv6@2605:6400:d4e0:1::4d   check
   server lux076    ipv6@2605:6400:d4e0:1::4e   check
   server lux077    ipv6@2605:6400:d4e0:1::4f   check
   server lux078    ipv6@2605:6400:d4e0:1::50   check
   server lux079    ipv6@2605:6400:d4e0:1::51   check
   server lux080    ipv6@2605:6400:d4e0:1::52   check
   server lux081    ipv6@2605:6400:d4e0:1::53   check
   server lux082    ipv6@2605:6400:d4e0:1::54   check
   server lux083    ipv6@2605:6400:d4e0:1::55   check
   server lux084    ipv6@2605:6400:d4e0:1::56   check
   server lux085    ipv6@2605:6400:d4e0:1::57   check
   server lux086    ipv6@2605:6400:d4e0:1::58   check
   server lux087    ipv6@2605:6400:d4e0:1::59   check
   server lux088    ipv6@2605:6400:d4e0:1::5a   check
   server lux089    ipv6@2605:6400:d4e0:1::5b   check
   server lux090    ipv6@2605:6400:d4e0:1::5c   check
   server lux091    ipv6@2605:6400:d4e0:1::5d   check
   server lux092    ipv6@2605:6400:d4e0:1::5e   check
   server lux093    ipv6@2605:6400:d4e0:1::5f   check
   server lux094    ipv6@2605:6400:d4e0:1::60   check
   server lux095    ipv6@2605:6400:d4e0:1::61   check
   server lux096    ipv6@2605:6400:d4e0:1::62   check
   server lux097    ipv6@2605:6400:d4e0:1::63   check
   server lux098    ipv6@2605:6400:d4e0:1::64   check
   server lux099    ipv6@2605:6400:d4e0:1::65   check
   server lux100    ipv6@2605:6400:d4e0:1::66   check
   server lux101    ipv6@2605:6400:d4e0:1::67   check
   server lux102    ipv6@2605:6400:d4e0:1::68   check
   server lux103    ipv6@2605:6400:d4e0:1::69   check
   server lux104    ipv6@2605:6400:d4e0:1::6a   check
   server lux105    ipv6@2605:6400:d4e0:1::6b   check
   server lux106    ipv6@2605:6400:d4e0:1::6c   check
   server lux107    ipv6@2605:6400:d4e0:1::6d   check
   server lux108    ipv6@2605:6400:d4e0:1::6e   check
   server lux109    ipv6@2605:6400:d4e0:1::6f   check
   server lux110    ipv6@2605:6400:d4e0:1::70   check
   server lux111    ipv6@2605:6400:d4e0:1::71   check
   server lux112    ipv6@2605:6400:d4e0:1::72   check
   server lux113    ipv6@2605:6400:d4e0:1::73   check
   server lux114    ipv6@2605:6400:d4e0:1::74   check
   server lux115    ipv6@2605:6400:d4e0:1::75   check
   server lux116    ipv6@2605:6400:d4e0:1::76   check
   server lux117    ipv6@2605:6400:d4e0:1::77   check
   server lux118    ipv6@2605:6400:d4e0:1::78   check
   server lux119    ipv6@2605:6400:d4e0:1::79   check
   server lux120    ipv6@2605:6400:d4e0:1::7a   check
   server lux121    ipv6@2605:6400:d4e0:1::7b   check
   server lux122    ipv6@2605:6400:d4e0:1::7c   check
   server lux123    ipv6@2605:6400:d4e0:1::7d   check
   server lux124    ipv6@2605:6400:d4e0:1::7e   check
   server lux125    ipv6@2605:6400:d4e0:1::7f   check
   server lux126    ipv6@2605:6400:d4e0:1::80   check
   server lux127    ipv6@2605:6400:d4e0:1::81   check
   server lux128    ipv6@2605:6400:d4e0:1::82   check
   server lux129    ipv6@2605:6400:d4e0:1::83   check
   server lux130    ipv6@2605:6400:d4e0:1::84   check
   server lux131    ipv6@2605:6400:d4e0:1::85   check
   server lux132    ipv6@2605:6400:d4e0:1::86   check
   server lux133    ipv6@2605:6400:d4e0:1::87   check
   server lux134    ipv6@2605:6400:d4e0:1::88   check
   server lux135    ipv6@2605:6400:d4e0:1::89   check
   server lux136    ipv6@2605:6400:d4e0:1::8a   check
   server lux137    ipv6@2605:6400:d4e0:1::8b   check
   server lux138    ipv6@2605:6400:d4e0:1::8c   check
   server lux139    ipv6@2605:6400:d4e0:1::8d   check
   server lux140    ipv6@2605:6400:d4e0:1::8e   check
   server lux141    ipv6@2605:6400:d4e0:1::8f   check
   server lux142    ipv6@2605:6400:d4e0:1::90   check
   server lux143    ipv6@2605:6400:d4e0:1::91   check
   server lux144    ipv6@2605:6400:d4e0:1::92   check
   server lux145    ipv6@2605:6400:d4e0:1::93   check
   server lux146    ipv6@2605:6400:d4e0:1::94   check
   server lux147    ipv6@2605:6400:d4e0:1::95   check
   server lux148    ipv6@2605:6400:d4e0:1::96   check
   server lux149    ipv6@2605:6400:d4e0:1::97   check
   server lux150    ipv6@2605:6400:d4e0:1::98   check
   server lux151    ipv6@2605:6400:d4e0:1::99   check
   server lux152    ipv6@2605:6400:d4e0:1::9a   check
   server lux153    ipv6@2605:6400:d4e0:1::9b   check
   server lux154    ipv6@2605:6400:d4e0:1::9c   check
   server lux155    ipv6@2605:6400:d4e0:1::9d   check
   server lux156    ipv6@2605:6400:d4e0:1::9e   check
   server lux157    ipv6@2605:6400:d4e0:1::9f   check
   server lux158    ipv6@2605:6400:d4e0:1::a0   check
   server lux159    ipv6@2605:6400:d4e0:1::a1   check
   server lux160    ipv6@2605:6400:d4e0:1::a2   check
   server lux161    ipv6@2605:6400:d4e0:1::a3   check
   server lux162    ipv6@2605:6400:d4e0:1::a4   check
   server lux163    ipv6@2605:6400:d4e0:1::a5   check
   server lux164    ipv6@2605:6400:d4e0:1::a6   check
   server lux165    ipv6@2605:6400:d4e0:1::a7   check
   server lux166    ipv6@2605:6400:d4e0:1::a8   check
   server lux167    ipv6@2605:6400:d4e0:1::a9   check
   server lux168    ipv6@2605:6400:d4e0:1::aa   check
   server lux169    ipv6@2605:6400:d4e0:1::ab   check
   server lux170    ipv6@2605:6400:d4e0:1::ac   check
   server lux171    ipv6@2605:6400:d4e0:1::ad   check
   server lux172    ipv6@2605:6400:d4e0:1::ae   check
   server lux173    ipv6@2605:6400:d4e0:1::af   check
   server lux174    ipv6@2605:6400:d4e0:1::b0   check
   server lux175    ipv6@2605:6400:d4e0:1::b1   check
   server lux176    ipv6@2605:6400:d4e0:1::b2   check
   server lux177    ipv6@2605:6400:d4e0:1::b3   check
   server lux178    ipv6@2605:6400:d4e0:1::b4   check
   server lux179    ipv6@2605:6400:d4e0:1::b5   check
   server lux180    ipv6@2605:6400:d4e0:1::b6   check
   server lux181    ipv6@2605:6400:d4e0:1::b7   check
   server lux182    ipv6@2605:6400:d4e0:1::b8   check
   server lux183    ipv6@2605:6400:d4e0:1::b9   check
   server lux184    ipv6@2605:6400:d4e0:1::ba   check
   server lux185    ipv6@2605:6400:d4e0:1::bb   check
   server lux186    ipv6@2605:6400:d4e0:1::bc   check
   server lux187    ipv6@2605:6400:d4e0:1::bd   check
   server lux188    ipv6@2605:6400:d4e0:1::be   check
   server lux189    ipv6@2605:6400:d4e0:1::bf   check
   server lux190    ipv6@2605:6400:d4e0:1::c0   check
   server lux191    ipv6@2605:6400:d4e0:1::c1   check
   server lux192    ipv6@2605:6400:d4e0:1::c2   check
   server lux193    ipv6@2605:6400:d4e0:1::c3   check
   server lux194    ipv6@2605:6400:d4e0:1::c4   check
   server lux195    ipv6@2605:6400:d4e0:1::c5   check
   server lux196    ipv6@2605:6400:d4e0:1::c6   check
   server lux197    ipv6@2605:6400:d4e0:1::c7   check
   server lux198    ipv6@2605:6400:d4e0:1::c8   check
   server lux199    ipv6@2605:6400:d4e0:1::c9   check
   server lux200    ipv6@2605:6400:d4e0:1::ca   check
   server lux201    ipv6@2605:6400:d4e0:1::cb   check
   server lux202    ipv6@2605:6400:d4e0:1::cc   check
   server lux203    ipv6@2605:6400:d4e0:1::cd   check
   server lux204    ipv6@2605:6400:d4e0:1::ce   check
   server lux205    ipv6@2605:6400:d4e0:1::cf   check
   server lux206    ipv6@2605:6400:d4e0:1::d0   check
   server lux207    ipv6@2605:6400:d4e0:1::d1   check
   server lux208    ipv6@2605:6400:d4e0:1::d2   check
   server lux209    ipv6@2605:6400:d4e0:1::d3   check
   server lux210    ipv6@2605:6400:d4e0:1::d4   check
   server lux211    ipv6@2605:6400:d4e0:1::d5   check
   server lux212    ipv6@2605:6400:d4e0:1::d6   check
   server lux213    ipv6@2605:6400:d4e0:1::d7   check
   server lux214    ipv6@2605:6400:d4e0:1::d8   check
   server lux215    ipv6@2605:6400:d4e0:1::d9   check
   server lux216    ipv6@2605:6400:d4e0:1::da   check
   server lux217    ipv6@2605:6400:d4e0:1::db   check
   server lux218    ipv6@2605:6400:d4e0:1::dc   check
   server lux219    ipv6@2605:6400:d4e0:1::dd   check
   server lux220    ipv6@2605:6400:d4e0:1::de   check
   server lux221    ipv6@2605:6400:d4e0:1::df   check
   server lux222    ipv6@2605:6400:d4e0:1::e0   check
   server lux223    ipv6@2605:6400:d4e0:1::e1   check
   server lux224    ipv6@2605:6400:d4e0:1::e2   check
   server lux225    ipv6@2605:6400:d4e0:1::e3   check
   server lux226    ipv6@2605:6400:d4e0:1::e4   check
   server lux227    ipv6@2605:6400:d4e0:1::e5   check
   server lux228    ipv6@2605:6400:d4e0:1::e6   check
   server lux229    ipv6@2605:6400:d4e0:1::e7   check
   server lux230    ipv6@2605:6400:d4e0:1::e8   check
   server lux231    ipv6@2605:6400:d4e0:1::e9   check
   server lux232    ipv6@2605:6400:d4e0:1::ea   check
   server lux233    ipv6@2605:6400:d4e0:1::eb   check
   server lux234    ipv6@2605:6400:d4e0:1::ec   check
   server lux235    ipv6@2605:6400:d4e0:1::ed   check
   server lux236    ipv6@2605:6400:d4e0:1::ee   check
   server lux237    ipv6@2605:6400:d4e0:1::ef   check
   server lux238    ipv6@2605:6400:d4e0:1::f0   check
   server lux239    ipv6@2605:6400:d4e0:1::f1   check
   server lux240    ipv6@2605:6400:d4e0:1::f2   check
   server lux241    ipv6@2605:6400:d4e0:1::f3   check
   server lux242    ipv6@2605:6400:d4e0:1::f4   check
   server lux243    ipv6@2605:6400:d4e0:1::f5   check
   server lux244    ipv6@2605:6400:d4e0:1::f6   check
   server lux245    ipv6@2605:6400:d4e0:1::f7   check
   server lux246    ipv6@2605:6400:d4e0:1::f8   check
   server lux247    ipv6@2605:6400:d4e0:1::f9   check


frontend ocserv-vpn
   bind *:4433 # openconnect server
   # When operating HAProxy in TCP mode, which is set with mode tcp, timeout server should be the same as timeout client. Link: https://gitlab.com/openconnect/ocserv/-/issues/431
   timeout client 305s
   use_backend ocserv-backend-servers


backend ocserv-backend-servers
   # When operating HAProxy in TCP mode, which is set with mode tcp, timeout server should be the same as timeout client.[start]
   timeout server 305s
   # When operating HAProxy in TCP mode, which is set with mode tcp, timeout server should be the same as timeout client.[end]
   option tcp-check
   tcp-check connect port 7443
   balance source
   server Poland6    admin6.somimobile.com   send-proxy-v2 check
   server Poland     admin.somimobile.com   send-proxy-v2 check
   server France     airline.somimobile.com send-proxy-v2 check
   server Milan      mxp.somimobile.com     send-proxy-v2 check


frontend xray-apac-vpn
   bind *:1443 # xray singapore
   use_backend xray-apac-backend-servers

backend xray-apac-backend-servers
   server singapore    apac.somimobile.com

